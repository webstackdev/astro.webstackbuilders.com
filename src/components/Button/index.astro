---
import type { ButtonProps } from './index'
import { baseClasses, sizeClasses, variantClasses } from './index'
import Sprite from '../Sprite/index.astro'

type Props = ButtonProps

const {
  text,
  variant = 'primary',
  size = 'medium',
  type = 'button',
  disabled = false,
  class: additionalClasses = '',
  id,
  ariaLabel,
  onClick,
  icon,
  iconPosition = 'left',
  iconSize,
  ...rest
} = Astro.props

// Combine all classes
const buttonClasses = [
  baseClasses,
  sizeClasses[size],
  variantClasses[variant],
  additionalClasses,
].filter(Boolean).join(' ')

// Determine icon size based on button size if not specified
const defaultIconSize = iconSize || (size === 'small' ? 16 : size === 'large' ? 24 : 20)
---

<button
  type={type}
  class={buttonClasses}
  disabled={disabled}
  id={id}
  aria-label={ariaLabel}
  onclick={onClick}
  {...rest}
>
  {icon && (iconPosition === 'left' || iconPosition === 'only') && (
    <Sprite name={icon} size={defaultIconSize} class={text ? 'mr-2' : ''} />
  )}
  {text && <span>{text}</span>}
  {icon && iconPosition === 'right' && (
    <Sprite name={icon} size={defaultIconSize} class="ml-2" />
  )}
  <slot />
</button>