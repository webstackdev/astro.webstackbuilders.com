---
import { getSiteUrl } from '@lib/config/siteUrlServer'
import contactData from '@content/contact.json'
import { absoluteUrl } from '@components/scripts/utils'
import { getMetaThemeData } from '@components/Head/server/meta'
import Seo from '@components/Head/Seo.astro'
import Social from '@components/Head/Social.astro'
import StructuredData from '@components/Head/StructuredData.astro'

export interface Props {
  /** Author name */
  author?: string
  /** Content type for OpenGraph metadata */
  contentType?: 'article' | 'website'
  /** Meta description */
  description?: string
  /** Last modified date */
  modifiedDate?: Date
  /** Whether search engines should ignore the page, default: false */
  noindex?: boolean
  /** Meta page title displayed in the browser tab and window title bar */
  pageTitle: string
  /** URL path component e.g. 'articles/my-article' */
  path: string
  /** Publication date for articles */
  publishDate?: Date
  /** Specifies the main, high-level category or theme of the article */
  section?: string
  /** Content tags */
  tags?: string[]
}

const {
  author,
  contentType,
  description,
  modifiedDate,
  noindex = false,
  pageTitle,
  path,
  publishDate,
  section,
  tags,
} = Astro.props

const defaultTheme = getMetaThemeData()
---

<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<meta name="description" content={description || contactData.company.description} />
<meta name="author" content={contactData.company.author.name} />
<meta name="robots" content={noindex ? 'noindex, nofollow' : 'index, follow'} />
<Seo
  path={path}
  {...contentType && { contentType }}
  {...publishDate && { publishDate }}
  {...modifiedDate && { modifiedDate }}
  {...author && { author }}
  {...section && { section }}
  {...tags && { tags }}
/>
{/* Open Graph meta tags for Twitter and Facebook social shares */}
<Social
  title={pageTitle}
  description={description || contactData.company.description}
  path={path}
/>
{/* JSON-LD Structured Data for search engines */}
<StructuredData
  path={path}
  pageTitle={pageTitle}
  {...description && { description }}
  {...contentType && { contentType }}
  {...publishDate && { publishDate }}
  {...modifiedDate && { modifiedDate }}
  {...author && { author }}
/>
{/* Used to sets the color of the surrounding user interface for e.g. the browser */}
{/* title bar. It is updated by script when the theme changes. Preserved across */}
{/* Astro View Transitions API page navigations so doesn't need reset. */}
<meta
  name="theme-color"
  content={defaultTheme.colors.backgroundOffset}
  transition:name="theme-color"
  transition:persist
/>
{/* Favicon links */}
<link rel="icon" href="/favicon.ico" />
<link rel="icon" type="image/svg+xml" href="/favicon.svg" />
{/* Apple-specific settings */}
<link rel="apple-touch-icon" href="/apple-touch-icon.png" />
{/* Status bar style with values such as "default" or "black-translucent" */}
<meta name="apple-mobile-web-app-status-bar-style" content="default" />
{/* Allows the web app to run in full-screen mode */}
<meta name="mobile-web-app-capable" content="yes">
{/* RSS Feed */}
<link
  type="application/rss+xml"
  rel="alternate"
  href={absoluteUrl('rss.xml', new URL(getSiteUrl()))}
  title={`RSS Feed for ${contactData.company.name}`}
/>
{/* Web App Manifest */}
<link rel="manifest" href="/manifest.json" />
{/* Webmentions */}
<link rel="pingback" href={`https://webmention.io/${Astro.site!.hostname}/xmlrpc`} />
<link rel="webmention" href={`https://webmention.io/${Astro.site!.hostname}/webmention`} />
<link rel="canonical" href={Astro.url.href} />
{/* Sitemap */}
<link rel="sitemap" href="/sitemap-index.xml" />