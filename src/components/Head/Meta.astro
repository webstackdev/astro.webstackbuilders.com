---
import contactData from '@content/contact.json'
import { absoluteUrl } from '@components/scripts/utils'
import { getMetaThemeData } from '@components/Head/server/meta'
import Seo from '@components/Head/Seo.astro'
import Social from '@components/Head/Social.astro'
import StructuredData from '@components/Head/StructuredData.astro'

export interface Props {
  pageTitle: string
  path: string
  description?: string
  image?: string
  contentType?: 'article' | 'website'
  publishDate?: Date
  modifiedDate?: Date
  author?: string
  section?: string
  tags?: string[]
  noindex?: boolean
}

const {
  pageTitle,
  path,
  description,
  image,
  contentType,
  publishDate,
  modifiedDate,
  author,
  section,
  tags,
  noindex = false,
} = Astro.props

const { slug, defaultTheme } = getMetaThemeData(path)
---

<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<meta name="description" content={description || contactData.company.description} />
<meta name="author" content={contactData.company.author.name} />
<meta name="robots" content={noindex ? 'noindex, nofollow' : 'index, follow'} />
<Seo
  path={path}
  {...contentType && { contentType }}
  {...publishDate && { publishDate }}
  {...modifiedDate && { modifiedDate }}
  {...author && { author }}
  {...section && { section }}
  {...tags && { tags }}
/>
{/* Open Graph meta tags for Twitter and Facebook social shares */}
<Social
  title={pageTitle}
  description={description || contactData.company.description}
  slug={slug}
  {...image && { image }}
/>
{/* JSON-LD Structured Data for search engines */}
<StructuredData
  path={path}
  pageTitle={pageTitle}
  {...description && { description }}
  {...image && { image }}
  {...contentType && { contentType }}
  {...publishDate && { publishDate }}
  {...modifiedDate && { modifiedDate }}
  {...author && { author }}
/>
{/* Used to sets the color of the surrounding user interface for e.g. the browser */}
{/* title bar. It is updated by script when the theme changes. Preserved across */}
{/* Astro View Transitions API page navigations so doesn't need reset. */}
<meta
  name="theme-color"
  content={defaultTheme.colors.backgroundOffset}
  transition:name="theme-color"
  transition:persist
/>
{/* Favicon links */}
<link rel="icon" href="/favicon.ico" />
<link rel="icon" type="image/svg+xml" href="/favicon.svg" />
{/* Apple-specific settings */}
<link rel="apple-touch-icon" href="/apple-touch-icon.png" />
{/* Status bar style with values such as "default" or "black-translucent" */}
<meta name="apple-mobile-web-app-status-bar-style" content="default" />
{/* Web manifest file for Progressive Web Application app usage */}
<link rel="manifest" href={absoluteUrl('manifest.json', Astro.site)} />
{/* Allows the web app to run in full-screen mode */}
<meta name="mobile-web-app-capable" content="yes">
{/* RSS Feed */}
<link
  type="application/rss+xml"
  rel="alternate"
  href={absoluteUrl('rss.xml', Astro.site)}
  title={`RSS Feed for ${contactData.company.name}`}
/>
{/* Webmentions */}
<link rel="pingback" href={`https://webmention.io/${Astro.site!.hostname}/xmlrpc`} />
<link rel="webmention" href={`https://webmention.io/${Astro.site!.hostname}/webmention`} />
<link rel="canonical" href={Astro.url.href} />
{/* Sitemap */}
<link rel="sitemap" href="/sitemap-index.xml" />