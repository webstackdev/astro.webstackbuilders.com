---
import Button from '@components/Button/index.astro'

const { ...rest } = Astro.props
---

<add-to-calendar {...rest} data-testid="add-to-calendar">
  <Button
    type="button"
    data-calendar-trigger={true}
    aria-expanded="false"
    variant="secondary"
    size="small"
    icon="calendar-generic-ical"
    iconSize={5}
    class="normal-case"
  >
    <span class="ml-2"><slot>Add to calendar</slot></span>
  </Button>

  <div
    data-calendar-menu
    class="hidden mt-2 border border-trim rounded-md bg-content-inverse text-content p-3 w-[min(22rem,90vw)]"
    role="menu"
    aria-label="Add this event to your calendar"
  >
    <div class="flex flex-col gap-2">
      <Button
        data-calendar-link="google"
        href="https://calendar.google.com/calendar/render"
        variant="secondary"
        size="small"
        icon="calendar-google"
        iconSize={5}
        text="Google Calendar"
        class="normal-case"
      />

      <Button
        data-calendar-link="outlook"
        href="https://outlook.office.com/calendar/0/deeplink/compose"
        variant="secondary"
        size="small"
        icon="calendar-outlook"
        iconSize={5}
        text="Outlook"
        class="normal-case"
      />

      <Button
        type="button"
        data-calendar-download-ics={true}
        variant="secondary"
        size="small"
        icon="calendar-apple"
        iconSize={5}
        text="Download .ics"
        class="normal-case"
      />
    </div>
  </div>
</add-to-calendar>

<script>
  import { registerAddToCalendarWebComponent } from '@components/Calendar/client'
  registerAddToCalendarWebComponent()
</script>
