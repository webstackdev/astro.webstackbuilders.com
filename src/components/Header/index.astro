---
import Brand from '@components/Brand/index.astro'
import Navigation from '@components/Navigation/index.astro'
import SearchBar from '@components/Search/SearchBar/index.astro'
import ThemeButton from '@components/ThemePicker/ThemeButton.astro'

export interface Props {
  /** The URL path component e.g. 'articles/my-article' */
  path: string
}

const { path } = Astro.props

import './index.css'
---

{/* Hidden modal shown when theme picker icon selected - moved to BaseLayout for persistence */}
{/* Header for all pages */}
<div class="header-shell">
  <div class="header-footprint" aria-hidden="true"></div>
  <div class="header-fixed">
    <header
      id="header"
      data-header-search-open="false"
      class="site-header group flex flex-row items-center justify-between relative"
      role="banner"
    >
      {/*- Element for animated background behind mobile navigation menu -*/}
      <div
        id="mobile-splash"
        class="mobile-splash"
        aria-hidden="true"
        data-testid="mobile-splash-backdrop"
      >
        <div
          id="mobile-splash-backdrop"
          class="mobile-splash-backdrop"
          aria-hidden="true"
        >
        </div>
      </div>
      {/* Logo and wordmark */}
      <span
        id="header__brand"
        class="header-brand flex items-center justify-between relative z-(--z-content-overlay)"
      >
        <Brand />
      </span>
      {/* Focus trap container for mobile navigation - invisible wrapper for accessibility */}
      <Navigation path={path} />
      {/* Theme picker toggle button to show modal */}
      <span
        id="header__theme-icon"
        class="header-icon order-3 lg:order-4 ml-2 mr-2 block shrink-0 w-(--header-icon-size) h-(--header-icon-size) relative z-(--z-content-overlay)"
      >
        <ThemeButton />
      </span>

      {/* Header search icon that expands left into a search panel */}
      <span
        id="header__search-icon"
        class="header-icon order-4 lg:order-5 mr-2 lg:mr-0 block shrink-0 w-(--header-icon-size) h-(--header-icon-size) relative z-(--z-content-overlay) group-data-[header-search-open=true]:z-(--z-modal) lg:z-(--z-nav)"
      >
        <SearchBar variant="header" />
      </span>
    </header>
  </div>
</div>

<script>
  import { initHeaderCollapseSideEffects } from '@components/Header/client'
  initHeaderCollapseSideEffects()
</script>
