---
/**
 * Newsletter Page Layout
 *
 * A centered, standalone newsletter signup form designed for the dedicated
 * /newsletter page. Features a prominent form with supporting content.
 */

import GDPRConsent from '@components/Consent/Checkbox/index.astro'
import Confetti from '@components/Animations/Confetti/index.astro'
import Icon from '@components/Icon/index.astro'
import type { NewsletterProps } from '@components/CallToAction/Newsletter/client/@types'

export type Props = Omit<NewsletterProps, 'variant'>

const {
  title = 'Stay Updated',
  description = 'Subscribe to our newsletter for the latest insights on web development and digital solutions.',
  placeholder = 'Enter your email address',
  buttonText = 'Subscribe',
} = Astro.props
---

<div class="w-full max-w-xl mx-auto">
  <div class="bg-page-base border border-trim rounded-2xl shadow-lg p-8 md:p-10">
    <div class="text-center mb-8">
      <div class="inline-flex items-center gap-2 mb-4">
        <span
          class="px-3 py-1 rounded-full bg-primary/10 text-primary text-xs font-bold uppercase tracking-wider border border-primary/20"
        >
          Monthly Dispatch
        </span>
      </div>
      <h2 class="text-2xl md:text-3xl font-black text-content leading-tight">
        {title}
      </h2>
      <p class="text-base text-content-offset mt-3 max-w-md mx-auto">
        {description}
      </p>
    </div>

    <form id="newsletter-form" class="space-y-5">
      <div class="space-y-1">
        <label
          id="newsletter-email-label"
          for="newsletter-email"
          class="text-xs font-bold text-content uppercase tracking-wide"
        >
          Work Email
        </label>
        <div class="relative after:pointer-events-none after:absolute after:content-[''] after:inset-0 after:rounded-none after:border-2 after:border-transparent focus-within:after:-inset-1 focus-within:after:border-spotlight">
          <input
            type="email"
            id="newsletter-email"
            name="email"
            placeholder={placeholder}
            class="w-full px-4 py-3 border border-trim rounded-lg bg-page-offset text-sm focus:outline-none focus-visible:outline-none transition-colors"
            required
            aria-describedby="newsletter-message"
          />
        </div>
      </div>

      <Confetti>
        <button
          type="submit"
          id="newsletter-submit"
          data-e2e-state="idle"
          class="relative w-full px-6 py-3 bg-content text-page-base font-bold rounded-lg text-sm transition-all transform hover:-translate-y-0.5 hover:shadow-lg flex items-center justify-center gap-2 hover:bg-primary disabled:opacity-50 disabled:cursor-not-allowed disabled:hover:translate-y-0 focus-visible:outline-none after:pointer-events-none after:absolute after:content-[''] after:inset-0 after:rounded-none after:border-2 after:border-transparent focus-visible:after:-inset-1 focus-visible:after:border-spotlight"
        >
          <span id="button-text">{buttonText}</span>
          <Icon
            icon="exit-right-thin"
            size={4}
            classes="transition-transform"
            id="button-arrow"
          />
          <Icon
            icon="spinner"
            size={4}
            classes="hidden animate-spin"
            id="button-spinner"
          />
        </button>
      </Confetti>

      <GDPRConsent
        purpose="marketing communications (unsubscribe anytime)"
        id="newsletter-gdpr-consent"
        name="consent"
        formId="newsletter_form"
        variant="newsletter-cta-home"
      />

      <p
        id="newsletter-message"
        class="text-xs text-content-offset leading-relaxed text-center"
        role="status"
        aria-live="polite"
        aria-atomic="true"
      >
        You'll receive a confirmation email. Click the link to complete your subscription.
      </p>
    </form>
  </div>
</div>
