---
/**
 * Prefetch offline page during idle time for service worker
 */
---

<script>
  import { handleScriptError } from '@components/scripts/errors/handler'

  const prefetch = (url: string) => {
    try {
      fetch(url, { credentials: 'same-origin' }).catch((error) => {
        handleScriptError(error, { scriptName: 'BaseLayout', operation: `prefetch ${url}` })
      })
    } catch (error) {
      handleScriptError(error, { scriptName: 'BaseLayout', operation: `prefetch ${url}` })
    }
  }
  if (typeof requestIdleCallback === 'function') {
    requestIdleCallback(() => prefetch('/offline'))
  } else {
    setTimeout(() => prefetch('/offline'), 500)
  }
</script>