---
import Icon from '@components/Icon/index.astro'

export interface Props {
  type?: 'warning' | 'action' | 'tip' | 'info' | 'note' | 'success' | 'danger'
}

const { type = 'info' } = Astro.props

const typeLabelMap = {
  warning: 'Warning',
  action: 'Action',
  tip: 'Tip',
  info: 'Info',
  note: 'Note',
  success: 'Success',
  danger: 'Danger',
} as const

// Map callout types to sprite icons
const iconMap = {
  warning: 'warning',
  action: 'warning',
  info: 'info',
  tip: 'lightbulb',
  note: 'question',
  success: 'check',
  danger: 'warning',
} as const

// Map callout types to their background color CSS custom properties
const backgroundColorMap = {
  warning: 'var(--color-danger-inverse)',
  action: 'var(--color-danger-inverse)',
  info: 'var(--color-info-inverse)',
  tip: 'var(--color-page-base-offset)',
  note: 'var(--color-page-base-offset)',
  success: 'var(--color-success-inverse)',
  danger: 'var(--color-danger-inverse)',
} as const

// Map callout types to their border/icon color CSS custom properties
const borderColorMap = {
  warning: 'var(--color-danger)',
  action: 'var(--color-danger)',
  info: 'var(--color-info)',
  tip: 'var(--color-content)',
  note: 'var(--color-content)',
  success: 'var(--color-success)',
  danger: 'var(--color-danger)',
} as const

const icon = iconMap[type] ?? iconMap.info
const backgroundColor = backgroundColorMap[type] ?? backgroundColorMap.info
const borderColor = borderColorMap[type] ?? borderColorMap.info
const typeLabel = typeLabelMap[type] ?? typeLabelMap.info
---

<style define:vars={{ backgroundColor, borderColor }}>
  .callout {
    background-color: var(--backgroundColor);
    border-left-color: var(--borderColor);
  }

  .callout__icon {
    color: var(--borderColor);
  }

  /* Spacing for nested elements */
  /* stylelint-disable-next-line selector-max-universal */
  .callout__content > * + * {
    margin-top: 2rem;
  }
</style>

<div class="callout border border--border border-l-0 rounded-r-lg relative pl-6" role="note">
  <div
    class="callout__icon bg-bg rounded-full absolute left-0 top-0 ml-0.5 p-1 -translate-x-1/2 -translate-y-1/2"
  >
    <Icon name={icon} size={20} />
  </div>

  <div class="callout__content border-l-4 p-4 md:pl-8">
    <span class="sr-only">{typeLabel} callout:</span>
    <slot />
  </div>
</div>
