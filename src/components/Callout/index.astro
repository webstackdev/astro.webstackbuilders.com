---
import Icon from '@components/Icon/index.astro'

export interface Props {
  type?: 'warning' | 'action' | 'tip' | 'info' | 'note' | 'success' | 'danger'
}

const { type = 'info' } = Astro.props

const typeLabelMap = {
  warning: 'Warning',
  action: 'Action',
  tip: 'Tip',
  info: 'Info',
  note: 'Note',
  success: 'Success',
  danger: 'Danger',
} as const

// Map callout types to sprite icons
const iconMap = {
  warning: 'warning',
  action: 'warning',
  info: 'info',
  tip: 'lightbulb',
  note: 'info',
  success: 'check',
  danger: 'warning',
} as const

// Map callout types to their background color CSS custom properties
const backgroundColorMap = {
  warning: 'var(--color-warning-inverse)',
  action: 'var(--color-warning-inverse)',
  info: 'var(--color-info-inverse)',
  tip: 'var(--color-success-inverse)',
  note: 'var(--color-note-inverse)',
  success: 'var(--color-success-inverse)',
  danger: 'var(--color-danger-inverse)',
} as const

// Map callout types to their border/icon color CSS custom properties
const borderColorMap = {
  warning: 'var(--color-warning)',
  action: 'var(--color-warning)',
  info: 'var(--color-info)',
  tip: 'var(--color-success)',
  note: 'var(--color-note)',
  success: 'var(--color-success)',
  danger: 'var(--color-danger)',
} as const

const icon = iconMap[type] ?? iconMap.info
const backgroundColor = backgroundColorMap[type] ?? backgroundColorMap.info
const borderColor = borderColorMap[type] ?? borderColorMap.info
const typeLabel = typeLabelMap[type] ?? typeLabelMap.info
const typeLabelUpper = typeLabel.toUpperCase()
---

<style define:vars={{ backgroundColor, borderColor }}>
  .callout {
    background-color: var(--backgroundColor);
    border: 0;
    border-left: 6px solid var(--borderColor);
    border-radius: 0;
    display: flex;
    flex-direction: column;
    gap: 0.75rem;
    padding: 1rem;
  }

  .callout__header {
    align-items: center;
    display: flex;
    gap: 0.5rem;
  }

  .callout__icon {
    color: var(--borderColor);
    transform: translateY(-2px);
  }

  .callout__icon :global(svg) {
    fill: currentcolor;
  }

  .callout__label {
    color: var(--borderColor);
    font-size: 1rem;
    font-weight: bold;
    letter-spacing: 0.08em;
    text-transform: uppercase;
  }

  /* Spacing for nested elements */
  .callout__content > :not(.sr-only) + :not(.sr-only) {
    margin-top: 2rem;
  }
</style>

<div class="callout" role="note">
  <div class="callout__header">
    <div class="callout__icon">
      <Icon name={icon} size={20} variant="custom" />
    </div>
    <div class="callout__label" aria-hidden="true">{typeLabelUpper}</div>
  </div>

  <div class="callout__content">
    <span class="sr-only">{typeLabel} callout:</span>
    <slot />
  </div>
</div>
