---
import Icon from '@components/Icon/index.astro'

export interface Props {
  type?: 'warning' | 'action' | 'tip' | 'info' | 'note' | 'success' | 'danger'
}

const { type = 'info' } = Astro.props

const typeLabelMap = {
  warning: 'Warning',
  action: 'Action',
  tip: 'Tip',
  info: 'Info',
  note: 'Note',
  success: 'Success',
  danger: 'Danger',
} as const

// Map callout types to icons
const iconMap = {
  warning: 'warning',
  action: 'warning',
  info: 'info-circled',
  tip: 'lightbulb',
  note: 'info-circled',
  success: 'check',
  danger: 'warning',
} as const

const typeContainerClassMap = {
  warning: 'bg-warning-inverse border-warning',
  action: 'bg-warning-inverse border-warning',
  info: 'bg-info-inverse border-info',
  tip: 'bg-success-inverse border-success',
  note: 'bg-note-inverse border-note',
  success: 'bg-success-inverse border-success',
  danger: 'bg-danger-inverse border-danger',
} as const

const typeAccentTextClassMap = {
  warning: 'text-warning',
  action: 'text-warning',
  info: 'text-info',
  tip: 'text-success',
  note: 'text-note-offset',
  success: 'text-success',
  danger: 'text-danger',
} as const

const typeBodyTextClassMap = {
  warning: 'text-content',
  action: 'text-content',
  info: 'text-content',
  tip: 'text-content',
  note: 'text-note',
  success: 'text-content',
  danger: 'text-content',
} as const

const icon = iconMap[type] ?? iconMap.info
const typeLabel = typeLabelMap[type] ?? typeLabelMap.info
const typeLabelUpper = typeLabel.toUpperCase()

const containerClasses = typeContainerClassMap[type] ?? typeContainerClassMap.info
const accentTextClasses = typeAccentTextClassMap[type] ?? typeAccentTextClassMap.info
const bodyTextClasses = typeBodyTextClassMap[type] ?? typeBodyTextClassMap.info
const iconColor = accentTextClasses.startsWith('text-') ? accentTextClasses.slice(5) : 'inherit'
---

<style>
  /* Spacing for nested elements */
  .callout__content > :not(.sr-only) + :not(.sr-only) {
    margin-top: 2rem;
  }
</style>

<div
  class:list={[
    containerClasses,
    'callout',
    'flex',
    'flex-col',
    'gap-3',
    'mb-6',
    'p-4',
    'border-0',
    'border-l-[6px]',
    'rounded-none',
  ]}
  role="note"
>
  <div class="flex items-center gap-2">
    <div
      class:list={[
        accentTextClasses,
        'callout__icon',
        '-translate-y-0.5',
      ]}
    >
      <Icon icon={icon} size={5} color={iconColor} />
    </div>
    <div
      class:list={[
        accentTextClasses,
        'text-base',
        'font-bold',
        'tracking-[0.08em]',
        'uppercase',
      ]}
      aria-hidden="true"
    >
      {typeLabelUpper}
    </div>
  </div>

  <div class:list={[bodyTextClasses, 'callout__content']}>
    <span class="sr-only">{typeLabel} callout:</span>
    <slot />
  </div>
</div>
