---
/**
 * X (Twitter) Tweet Embed Component
 * A component to embed tweets in MDX content with fallback styling
 *
 * Usage in MDX:
 * <X
 *   id="1234567890123456789"
 *   author="username"
 *   content="This is the tweet content..."
 *   date="2024-01-15"
 *   avatar="/path/to/avatar.jpg"
 * />
 */

interface Props {
  id: string
  author?: string
  content?: string
  date?: string
  avatar?: string
  className?: string
}

const {
  id,
  author = 'Twitter User',
  content = 'Loading tweet...',
  date = new Date().toLocaleDateString(),
  avatar = '/assets/images/default-avatar.png',
  className = '',
} = Astro.props

// Format the date nicely
const formattedDate = new Date(date).toLocaleDateString('en-US', {
  year: 'numeric',
  month: 'short',
  day: 'numeric',
})
---

<div
  class={`border border-[color:var(--color-border)] rounded-xl block mx-auto my-8 max-w-2xl p-6 bg-[color:var(--color-bg)] shadow-sm hover:shadow-md transition-shadow duration-200 ${className}`}
  data-tweet-id={id}
>
  <!-- Tweet Header -->
  <div class="flex items-center mb-3">
    <img
      src={avatar}
      alt={`${author} avatar`}
      class="w-12 h-12 rounded-full mr-3 border-2 border-[color:var(--color-border)]"
      loading="lazy"
    />
    <div class="flex-1">
      <div class="flex items-center space-x-2">
        <h4 class="font-bold text-[color:var(--color-text)] text-base m-0">
          @{author}
        </h4>
        <svg
          class="w-5 h-5 text-[color:var(--color-primary)]"
          fill="currentColor"
          viewBox="0 0 24 24"
        >
          <path
            d="M22.46 6c-.85.38-1.78.64-2.75.76 1-.6 1.76-1.55 2.12-2.68-.93.55-1.96.95-3.06 1.17-.88-.94-2.13-1.53-3.51-1.53-2.66 0-4.81 2.16-4.81 4.81 0 .38.04.75.13 1.1-4-.2-7.57-2.11-9.96-5.02-.42.72-.66 1.55-.66 2.44 0 1.67.85 3.14 2.14 4-.79-.02-1.53-.24-2.18-.6v.06c0 2.33 1.66 4.27 3.86 4.71-.4.11-.83.17-1.27.17-.31 0-.62-.03-.92-.08.62 1.94 2.43 3.35 4.58 3.39-1.68 1.32-3.8 2.1-6.1 2.1-.4 0-.79-.02-1.17-.07 2.18 1.4 4.77 2.21 7.55 2.21 9.06 0 14.01-7.5 14.01-14.01 0-.21 0-.42-.01-.63.96-.69 1.8-1.56 2.46-2.55z"
          ></path>
        </svg>
      </div>
      <p class="text-[color:var(--color-text-offset)] text-sm m-0">
        {formattedDate}
      </p>
    </div>
  </div>

  <!-- Tweet Content -->
  <div class="mb-4">
    <p class="text-[color:var(--color-text)] text-base leading-relaxed m-0">
      {content}
    </p>
  </div>

  <!-- Tweet Actions/Footer -->
  <div class="flex items-center justify-between pt-3 border-t border-[color:var(--color-border)]">
    <a
      href={`https://twitter.com/intent/tweet?in_reply_to=${id}`}
      target="_blank"
      rel="noopener noreferrer"
      class="flex items-center space-x-1 text-[color:var(--color-text-offset)] hover:text-[color:var(--color-primary)] transition-colors text-sm border-0 shadow-none hover:shadow-none"
    >
      <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path
          stroke-linecap="round"
          stroke-linejoin="round"
          stroke-width="2"
          d="M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"
        ></path>
      </svg>
      <span>Reply</span>
    </a>

    <a
      href={`https://twitter.com/intent/retweet?tweet_id=${id}`}
      target="_blank"
      rel="noopener noreferrer"
      class="flex items-center space-x-1 text-[color:var(--color-text-offset)] hover:text-[color:var(--color-success)] transition-colors text-sm border-0 shadow-none hover:shadow-none"
    >
      <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path
          stroke-linecap="round"
          stroke-linejoin="round"
          stroke-width="2"
          d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"
        ></path>
      </svg>
      <span>Retweet</span>
    </a>

    <a
      href={`https://twitter.com/intent/like?tweet_id=${id}`}
      target="_blank"
      rel="noopener noreferrer"
      class="flex items-center space-x-1 text-[color:var(--color-text-offset)] hover:text-[color:var(--color-danger)] transition-colors text-sm border-0 shadow-none hover:shadow-none"
    >
      <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path
          stroke-linecap="round"
          stroke-linejoin="round"
          stroke-width="2"
          d="M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z"
        ></path>
      </svg>
      <span>Like</span>
    </a>

    <a
      href={`https://twitter.com/twitter/status/${id}`}
      target="_blank"
      rel="noopener noreferrer"
      class="text-[color:var(--color-text-offset)] hover:text-[color:var(--color-primary)] transition-colors text-sm border-0 shadow-none hover:shadow-none"
    >
      View on X
    </a>
  </div>
</div>

<script>
  // Enhanced functionality could be added here:
  // - Load actual tweet data from Twitter API
  // - Handle real-time interaction counts
  // - Add proper loading states

  document.addEventListener('DOMContentLoaded', function () {
    const tweetElements = document.querySelectorAll('[data-tweet-id]')

    tweetElements.forEach(element => {
      // Add hover effect
      element.addEventListener('mouseenter', function (this: HTMLElement) {
        this.classList.add('scale-[1.02]')
      })

      element.addEventListener('mouseleave', function (this: HTMLElement) {
        this.classList.remove('scale-[1.02]')
      })
    })
  })
</script>
