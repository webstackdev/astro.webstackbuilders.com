---
/**
 * Newsletter Signup Component
 * A stylish newsletter signup form for use in MDX content
 *
 * Usage in MDX:
 * <Signup
 *   title="Stay Updated"
 *   description="Get the latest articles and insights delivered to your inbox."
 *   buttonText="Subscribe"
 *   placeholder="Enter your email"
 * />
 */

// Global function declaration
declare global {
  function handleSignup(form: any): void;
}

interface Props {
  title?: string
  description?: string
  buttonText?: string
  placeholder?: string
  className?: string
}

const {
  title = "Newsletter Signup",
  description = "Subscribe to get the latest updates and insights.",
  buttonText = "Subscribe",
  placeholder = "Enter your email address",
  className = ""
} = Astro.props
---

<div class={`bg-gradient-to-br from-blue-50 to-indigo-100 bg-[color:var(--color-bg-offset)] rounded-xl p-8 my-8 shadow-lg border border-[color:var(--color-border)] ${className}`}>
  <div class="max-w-md mx-auto text-center">
    <h3 class="text-2xl font-bold text-[color:var(--color-text)] mb-3">
      {title}
    </h3>

    <p class="text-[color:var(--color-text-offset)] mb-6 leading-relaxed">
      {description}
    </p>

    <form
      action="#"
      method="POST"
      class="space-y-4"
      onsubmit="event?.preventDefault(); handleSignup(this);"
    >
      <div class="relative">
        <input
          type="email"
          name="email"
          required
          placeholder={placeholder}
          class="w-full px-4 py-3 rounded-lg border border-[color:var(--color-border)] bg-[color:var(--color-bg)] text-[color:var(--color-text)] placeholder-[color:var(--color-text-offset)] focus:ring-2 focus:ring-[color:var(--color-primary)] focus:border-transparent transition-all duration-200 shadow-sm"
        />
      </div>

      <button
        type="submit"
        class="w-full bg-[color:var(--color-primary)] hover:bg-[color:var(--color-primary-offset)] text-white font-semibold py-3 px-6 rounded-lg transition-colors duration-200 transform hover:scale-105 focus:ring-2 focus:ring-[color:var(--color-primary)] focus:ring-offset-2 focus:outline-none shadow-md"
      >
        {buttonText}
      </button>
    </form>

    <p class="text-xs text-[color:var(--color-text-offset)] opacity-75 mt-4">
      We respect your privacy. Unsubscribe at any time.
    </p>
  </div>
</div>

<script>
  (window as any).handleSignup = function handleSignup(form: any) {
    // const email = form.email.value; // Commented out as it's not used
    const button = form.querySelector('button[type="submit"]');
    const originalText = button.textContent;

    // Show loading state
    button.textContent = 'Subscribing...';
    button.disabled = true;

    // Here you would typically send the email to your newsletter service
    // For now, we'll simulate success after a short delay
    setTimeout(() => {
      button.textContent = 'Subscribed!';
      button.classList.remove('bg-[color:var(--color-primary)]', 'hover:bg-[color:var(--color-primary-offset)]');
      button.classList.add('bg-[color:var(--color-success)]');

      // Reset after 3 seconds
      setTimeout(() => {
        button.textContent = originalText;
        button.disabled = false;
        button.classList.remove('bg-[color:var(--color-success)]');
        button.classList.add('bg-[color:var(--color-primary)]', 'hover:bg-[color:var(--color-primary-offset)]');
        form.reset();
      }, 3000);
    }, 1000);
  }
</script>