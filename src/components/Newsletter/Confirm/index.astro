---
export interface Props {
  token?: string
}

const { token } = Astro.props
---

<newsletter-confirm class="block" token={token}>
  <div class="container mx-auto px-4 py-16 max-w-2xl">
    <div class="bg-page-base -base border border-offset rounded-lg p-8 shadow-sm">
      <p
        id="confirmation-status"
        class="sr-only"
        role="status"
        aria-live="polite"
        aria-atomic="true"
      >
      </p>

    <!-- Loading state -->
    <div id="loading-state">
      <div class="text-center">
        <svg
          class="w-16 h-16 mx-auto text-accent mb-4 animate-spin"
          aria-hidden="true"
          focusable="false"
          fill="none"
          stroke="currentColor"
          viewBox="0 0 24 24"
        >
          <path
            stroke-linecap="round"
            stroke-linejoin="round"
            stroke-width="2"
            d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"
          ></path>
        </svg>
        <h2 class="text-2xl font-bold mb-2" id="confirm-heading-loading" tabindex="-1">
          Confirming your subscription...
        </h2>
        <p class="text-content-active">Please wait while we verify your confirmation link.</p>
      </div>
    </div>

    <!-- Success state -->
    <div id="success-state" class="hidden">
      <div class="text-center mb-6">
        <svg
          class="w-16 h-16 mx-auto text-green-500 mb-4"
          aria-hidden="true"
          focusable="false"
          fill="none"
          stroke="currentColor"
          viewBox="0 0 24 24"
        >
          <path
            stroke-linecap="round"
            stroke-linejoin="round"
            stroke-width="2"
            d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
        </svg>
        <h2 class="text-3xl font-bold mb-2" id="confirm-heading-success" tabindex="-1">
          Subscription Confirmed!
        </h2>
      </div>

      <div class="prose prose-invert max-w-none">
        <p class="text-lg text-content-active mb-4">
          Thank you for confirming your subscription, <strong id="user-email"></strong>!
        </p>

        <p class="text-content-active mb-4">
          You're now subscribed to our newsletter and will receive:
        </p>

        <ul class="text-content-active mb-6">
          <li>Web development insights and best practices</li>
          <li>Updates about new articles and case studies</li>
          <li>Exclusive Webstack Builders news</li>
        </ul>

        <div class="bg-page-offset border border-offset rounded p-4 text-sm text-content-active mb-6">
          <p class="font-semibold mb-2">Your Rights:</p>
          <p>
            You can unsubscribe at any time using the link in any email we send. See our <a
              href="/privacy"
              class="text-accent hover:underline">Privacy Policy</a
            >
            for details about how we handle your data.
          </p>
        </div>

        <div class="text-center">
          <a
            href="/articles/"
            class="inline-block bg-accent text-content-active px-6 py-3 rounded-lg hover:bg-accent-offset transition-colors font-semibold"
          >
            Browse Our Articles
          </a>
        </div>
      </div>
    </div>

    <!-- Expired state -->
    <div id="expired-state" class="hidden">
      <div class="text-center mb-6">
        <svg
          class="w-16 h-16 mx-auto text-yellow-500 mb-4"
          aria-hidden="true"
          focusable="false"
          fill="none"
          stroke="currentColor"
          viewBox="0 0 24 24"
        >
          <path
            stroke-linecap="round"
            stroke-linejoin="round"
            stroke-width="2"
            d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"></path>
        </svg>
        <h2 class="text-3xl font-bold mb-2" id="confirm-heading-expired" tabindex="-1">
          Confirmation Link Expired
        </h2>
      </div>

      <div class="prose prose-invert max-w-none">
        <p class="text-lg text-content-active mb-4">
          This confirmation link has expired or has already been used.
        </p>

        <p class="text-content-active mb-6">
          Confirmation links are valid for 24 hours for security reasons. If you'd like to
          subscribe, please sign up again below.
        </p>

        <div class="text-center">
          <a
            href="/#newsletter"
            class="inline-block bg-accent text-content-active px-6 py-3 rounded-lg hover:bg-accent-offset transition-colors font-semibold"
          >
            Sign Up Again
          </a>
        </div>
      </div>
    </div>

    <!-- Error state -->
    <div id="error-state" class="hidden">
      <div class="text-center mb-6">
        <svg
          class="w-16 h-16 mx-auto text-red-500 mb-4"
          aria-hidden="true"
          focusable="false"
          fill="none"
          stroke="currentColor"
          viewBox="0 0 24 24"
        >
          <path
            stroke-linecap="round"
            stroke-linejoin="round"
            stroke-width="2"
            d="M10 14l2-2m0 0l2-2m-2 2l-2-2m2 2l2 2m7-2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
        </svg>
        <h2 class="text-3xl font-bold mb-2" id="error-title" tabindex="-1">
          Confirmation Error
        </h2>
      </div>

      <div class="prose prose-invert max-w-none">
        <p class="text-lg text-content-active mb-4" id="error-message">
          An error occurred while confirming your subscription.
        </p>

        <p class="text-sm text-red-400 mb-6 hidden" id="error-details"></p>

        <p class="text-content-active mb-6">
          If you believe this is an error, please try signing up again or
          <a href="/contact/" class="text-accent hover:underline">contact us</a> for assistance.
        </p>

        <div class="text-center">
          <a
            href="/#newsletter"
            class="inline-block bg-accent text-content-active px-6 py-3 rounded-lg hover:bg-accent-offset transition-colors font-semibold mr-4"
          >
            Sign Up
          </a>
          <a
            href="/contact/"
            class="inline-block bg-page-offset text-content px-6 py-3 rounded-lg hover:bg-page-offset-hover transition-colors font-semibold"
          >
            Get Help
          </a>
        </div>
      </div>
    </div>
    </div>
  </div>
</newsletter-confirm>

<script>
  import { registerNewsletterConfirm } from '@components/Newsletter/Confirm/client/index'
  registerNewsletterConfirm()
</script>
