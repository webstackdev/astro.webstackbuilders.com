---
import { Image } from 'astro:assets'
import logoSvg from '@assets/images/site/logo.svg'
---

<consent-preferences class="block w-full">
  <section
    class="bg-content-inverse rounded-2xl shadow-2xl max-w-4xl w-full"
    aria-labelledby="consent-preferences__title"
    aria-describedby="consent-preferences__settings-desc"
  >
    <div class="px-6 py-4 flex items-center justify-between border-b border-page-base-offset">
      <div class="flex items-center gap-4">
        <Image src={logoSvg} alt="Webstack Builders corporate logo." class="h-8 w-auto" />
        <h2 id="consent-preferences__title" class="text-2xl font-bold text-content">
          Privacy Preference Center
        </h2>
      </div>
    </div>

    <div class="px-6 py-8">
      {/* Introduction */}
      <div class="mb-8">
        <p id="consent-preferences__settings-desc" class="text-content-muted leading-relaxed">
          When you visit our website, we may store information in your browser or device to make the
          site work and provide a better experience. This includes both cookies and local storage.
          The information we collect might relate to you, your preferences, or your device. You can
          choose which types of data storage to allow, though some choices may affect how the site
          works. Click on the different categories below to learn more and customize your
          preferences.
        </p>
      </div>

      {/* Data Storage Categories */}
      <div class="space-y-6">
        {/* Strictly Necessary */}
        <div class="border border-gray-200 dark:border-gray-700 rounded-xl p-6">
          <div class="flex items-center justify-between mb-4">
            <div>
              <h3 class="text-lg font-semibold text-gray-900 dark:text-white">Essential Data</h3>
              <p class="text-sm text-gray-600 dark:text-gray-400">
                Always Active - Required for the website to work
              </p>
            </div>
            <div class="flex items-center">
              <span
                class="text-sm text-green-600 dark:text-green-400 font-medium bg-green-100 dark:bg-green-900/30 px-3 py-1 rounded-full"
              >
                Always Active
              </span>
            </div>
          </div>
          <p class="text-gray-600 dark:text-gray-300 text-sm leading-relaxed">
            We need to store some information for our website to work properly. This includes things
            like your privacy preferences, login status, and form data. We can't turn this off, as
            the site wouldn't function without it. This data doesn't identify you personally and is
            only used to make the site work as you'd expect.
          </p>
        </div>

        {/* Performance and Analytics */}
        <div class="border border-gray-200 dark:border-gray-700 rounded-xl p-6">
          <div class="flex items-center justify-between mb-4">
            <div>
              <h3
                id="consent-preferences__analytics-title"
                class="text-lg font-semibold text-gray-900 dark:text-white"
              >
                Performance and Analytics
              </h3>
              <p
                id="consent-preferences__analytics-desc"
                class="text-sm text-gray-600 dark:text-gray-400"
              >
                Helps us understand how visitors use our website
              </p>
            </div>
            <label
              class="relative inline-flex items-center cursor-pointer"
              data-consent-toggle="analytics-cookies"
            >
              <input
                type="checkbox"
                id="analytics-cookies"
                class="sr-only peer"
                role="switch"
                aria-labelledby="consent-preferences__analytics-title"
                aria-describedby="consent-preferences__analytics-desc"
                checked
              />
              <div
                class="w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 dark:peer-focus:ring-blue-800 rounded-full peer dark:bg-gray-700 peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-0.5 after:left-0.5 after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all dark:border-gray-600 peer-checked:bg-blue-600"
              >
              </div>
            </label>
          </div>
          <p class="text-gray-600 dark:text-gray-300 text-sm leading-relaxed">
            These tools, including Google Analytics, help us count visits and understand where
            traffic comes from so we can improve our site. They show us which pages are popular and
            how people navigate around. All the information collected is anonymous - we see trends,
            not individuals. If you opt out, we won't know when you've visited and can't measure how
            well the site is working.
          </p>
        </div>

        {/* Functional */}
        <div class="border border-gray-200 dark:border-gray-700 rounded-xl p-6">
          <div class="flex items-center justify-between mb-4">
            <div>
              <h3
                id="consent-preferences__functional-title"
                class="text-lg font-semibold text-gray-900 dark:text-white"
              >
                Enhanced Features
              </h3>
              <p
                id="consent-preferences__functional-desc"
                class="text-sm text-gray-600 dark:text-gray-400"
              >
                Remembers your social media preferences
              </p>
            </div>
            <label
              class="relative inline-flex items-center cursor-pointer"
              data-consent-toggle="functional-cookies"
            >
              <input
                type="checkbox"
                id="functional-cookies"
                class="sr-only peer"
                role="switch"
                aria-labelledby="consent-preferences__functional-title"
                aria-describedby="consent-preferences__functional-desc"
              />
              <div
                class="w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 dark:peer-focus:ring-blue-800 rounded-full peer dark:bg-gray-700 peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-0.5 after:left-0.5 after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all dark:border-gray-600 peer-checked:bg-blue-600"
              >
              </div>
            </label>
          </div>
          <p class="text-gray-600 dark:text-gray-300 text-sm leading-relaxed mb-3">
            This feature remembers your Mastodon instance when you use the "Share to Mastodon"
            button. It's completely optional and requires your permission because it stores
            information about which Mastodon server you use, which could identify you.
          </p>
          <div
            class="bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800 rounded-lg p-4"
          >
            <p class="text-sm text-blue-800 dark:text-blue-200 leading-relaxed">
              <strong>Note:</strong> Your theme preference and social media embed caching are classified
              as "essential" and work without requiring consent. Enhanced features are only for optional
              conveniences like remembering your Mastodon instance. You can opt in to enable these extras.
            </p>
          </div>
        </div>

        {/* Marketing */}
        <div class="border border-gray-200 dark:border-gray-700 rounded-xl p-6">
          <div class="flex items-center justify-between mb-4">
            <div>
              <h3
                id="consent-preferences__marketing-title"
                class="text-lg font-semibold text-gray-900 dark:text-white"
              >
                Marketing and Advertising
              </h3>
              <p
                id="consent-preferences__marketing-desc"
                class="text-sm text-gray-600 dark:text-gray-400"
              >
                Used to deliver relevant advertisements
              </p>
            </div>
            <label
              class="relative inline-flex items-center cursor-pointer"
              data-consent-toggle="marketing-cookies"
            >
              <input
                type="checkbox"
                id="marketing-cookies"
                class="sr-only peer"
                role="switch"
                aria-labelledby="consent-preferences__marketing-title"
                aria-describedby="consent-preferences__marketing-desc"
              />
              <div
                class="w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 dark:peer-focus:ring-blue-800 rounded-full peer dark:bg-gray-700 peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-0.5 after:left-0.5 after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all dark:border-gray-600 peer-checked:bg-blue-600"
              >
              </div>
            </label>
          </div>
          <p class="text-gray-600 dark:text-gray-300 text-sm leading-relaxed">
            These tools help identify unique browsing sessions to show generic ads. We don't collect
            information to show you targeted ads based on your behavior. However, advertising
            partners may use these tools to build a profile of your interests and show you relevant
            ads on other sites. They don't store personal information directly, but identify your
            browser and device. If you opt out, you may see less relevant advertising.
          </p>
        </div>
      </div>
    </div>

    <div class="bg-content-inverse border-t border-page-base-offset px-6 py-4 flex gap-3 justify-end flex-wrap">
      <button
        id="consent-deny-all"
        class="px-6 py-2 bg-spotlight text-content rounded-lg hover:bg-spotlight-offset transition-colors duration-200 font-medium"
      >
        Decline All
      </button>
      <button
        id="consent-save-preferences"
        class="px-6 py-2 bg-gray-300 text-white rounded-lg hover:bg-gray-700transition-colors duration-200 font-medium"
      >
        Save My Preferences
      </button>
      <button
        id="consent-allow-all"
        class="px-6 py-2 bg-spotlight text-white rounded-lg hover:bg-spotlight-offset transition-colors duration-200 font-medium"
      >
        Allow All
      </button>
    </div>
  </section>
</consent-preferences>

<!-- Privacy Preferences Management Script -->
<script>
  import { registerConsentPreferencesWebComponent } from '@components/Consent/Preferences/client'
  registerConsentPreferencesWebComponent()
</script>
