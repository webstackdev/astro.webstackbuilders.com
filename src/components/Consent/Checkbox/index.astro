---
/**
 * GDPR Consent Component
 *
 * Reusable checkbox component for GDPR-compliant data collection consent.
 * Use in forms that collect personal data (contact forms, newsletter, etc.)
 *
 * @example
 * ```astro
 * <GDPRConsent
 *   purpose="responding to your inquiry"
 * />
 * ```
 */

import type { ConsentCheckboxProps } from './@types'
export type Props = ConsentCheckboxProps

import DefaultCheckbox from './default.astro'
import NewsletterCtaArticleCheckbox from './newsletter-cta-article.astro'
import NewsletterCtaHomeCheckbox from './newsletter-cta-home.astro'

const {
  purpose,
  customText,
  privacyPolicyUrl = '/privacy',
  cookiePolicyUrl = '/consent',
  name = 'consent',
  id = 'gdpr-consent',
  formId,
  variant = 'default',
} = Astro.props as Props

const optionalProps = {
  ...(customText !== undefined ? { customText } : {}),
  ...(formId !== undefined ? { formId } : {}),
}
---

<consent-checkbox data-purpose={purpose} data-form-id={formId ?? undefined}>
  {variant === 'newsletter-cta-article' && (
    <NewsletterCtaArticleCheckbox
      purpose={purpose}
      privacyPolicyUrl={privacyPolicyUrl}
      cookiePolicyUrl={cookiePolicyUrl}
      name={name}
      id={id}
      {...optionalProps}
    />
  )}
  {variant === 'newsletter-cta-home' && (
    <NewsletterCtaHomeCheckbox
      purpose={purpose}
      privacyPolicyUrl={privacyPolicyUrl}
      cookiePolicyUrl={cookiePolicyUrl}
      name={name}
      id={id}
      {...optionalProps}
    />
  )}
  {variant === 'default' && (
    <DefaultCheckbox
      purpose={purpose}
      privacyPolicyUrl={privacyPolicyUrl}
      cookiePolicyUrl={cookiePolicyUrl}
      name={name}
      id={id}
      {...optionalProps}
    />
  )}
</consent-checkbox>

<script>
  import { registerConsentCheckboxWebComponent } from '@components/Consent/Checkbox/client'
  registerConsentCheckboxWebComponent()
</script>
