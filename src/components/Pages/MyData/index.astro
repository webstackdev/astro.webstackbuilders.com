---
import Button from '@components/Button/index.astro'
import Icon from '@components/Icon/index.astro'
import List from '@components/List/index.astro'

export type Props = {
  content: {
    header: {
      title: string
      description: string
    }
    intro: string
    introLinks: {
      privacyPolicyText: string
      consentPreferencesText: string
    }
    accessData: {
      heading: string
      description: string
      label: string
      buttonText: string
    },
     deleteData: {
      heading: string
      description: string
      label: string
      buttonText: string
      confirmText: string
    },
    next: {
      heading: string
      items: {
        lead: string
        text: string
      }[]
    }
  }
}

const { content } = Astro.props
---

<privacy-form class="block">
  <div class="container mx-auto px-4 py-16 max-w-5xl space-y-10">
    <div
      id="status-message"
      tabindex="-1"
      role="status"
      aria-live="polite"
      aria-atomic="true"
      class="hidden rounded-xl border px-4 py-3 text-sm"
    ></div>

    <section
      class="flex flex-col items-center bg-page-offset border border-trim rounded-2xl p-6"
      aria-labelledby="my-data-intro-title"
    >
      <h2 class="sr-only" id="my-data-intro-title">Overview</h2>
      <p class="text-content-active">
        {content.intro}
      </p>
      <div class="mt-4 flex justify-evenly gap-8">
        <a
          href="/privacy"
          class="text-page-inverse underline decoration-page-inverse decoration-dotted underline-offset-4 hover:text-secondary hover:decoration-secondary focus-visible:outline-2 focus-visible:outline-spotlight focus-visible:outline-offset-2"
        >
          {content.introLinks.privacyPolicyText}
        </a>
        <a
          href="/consent"
          class="text-page-inverse underline decoration-page-inverse decoration-dotted underline-offset-4 hover:text-secondary hover:decoration-secondary focus-visible:outline-2 focus-visible:outline-spotlight focus-visible:outline-offset-2"
        >
          {content.introLinks.consentPreferencesText}
        </a>
      </div>
    </section>

    <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
      <sectionclass
        class="bg-content-inverse border border-trim rounded-2xl p-2 md:p-4"
        aria-labelledby="my-data-access-title"
      >
        <h2 id="my-data-access-title" class="text-page-inverse text-xl font-semibold mb-3">
          {content.accessData.heading}
        </h2>
        <p class="text-content-active">
          {content.accessData.description}
        </p>

        <form id="access-form" class="mt-6 space-y-4" novalidate>
          <div class="space-y-2">
            <label for="access-email" class="block text-content-active text-sm font-medium">
              {content.accessData.label}
            </label>
            <input
              type="email"
              id="access-email"
              name="email"
              required
              placeholder="your@email.com"
              class="w-full rounded-md border border-content bg-content-inverse px-3 py-2 placeholder:text-content-active focus:border-primary transition-colors duration-200 focus-visible:outline-2 focus-visible:outline-spotlight focus-visible:outline-offset-2 focus-visible:rounded-none"
            />
          </div>

          <Button
            type="submit"
            variant="info"
            class="mt-8 px-6 py-3"
            text={content.accessData.buttonText}
          />

          <div
            id="access-message"
            class="hidden rounded-xl border px-4 py-3 text-sm"
            role="status"
            aria-live="polite"
            aria-atomic="true"
            tabindex="-1"
          ></div>
        </form>
      </sectionclass>

      <section
        class="bg-content-inverse border border-trim rounded-2xl p-2 md:p-4"
        aria-labelledby="my-data-delete-title"
      >
        <h2 id="my-data-delete-title" class="text-page-inverse text-xl font-semibold mb-3">
          {content.deleteData.heading}
        </h2>

        <div class="flex rounded-xl border border-warning bg-warning-inverse text-warning px-4 py-3 text-sm mb-4">
          <span class="mt-2">
            <Icon
              icon="warning"
              color="warning-offset"
              size={6}
            />
          </span>
          <span class="ml-3">{content.deleteData.description}</span>
        </div>

        <form id="delete-form" class="mt-11 space-y-4" novalidate>
          <div class="space-y-2">
            <label for="delete-email" class="block text-content-active text-sm font-medium">
              {content.deleteData.label}
            </label>
            <input
              type="email"
              id="delete-email"
              name="email"
              required
              placeholder="your@email.com"
              class="w-full rounded-md border border-content bg-content-inverse px-3 py-2 placeholder:text-content-active transition-colors duration-200 focus-visible:outline-2 focus-visible:outline-spotlight focus-visible:outline-offset-2 focus-visible:rounded-none"
            />
          </div>

          <label class="flex items-start gap-3 text-sm">
            <input
              type="checkbox"
              id="confirm-delete"
              required
              class="mt-1 focus-visible:outline-2 focus-visible:outline-spotlight focus-visible:outline-offset-2 focus-visible:rounded-none"
            />
            <span class="mt-0.5">{content.deleteData.confirmText}</span>
          </label>

          <Button
            type="submit"
            variant="warning"
            class="px-6 py-3"
            text={content.deleteData.buttonText}
          />

          <div
            id="delete-message"
            class="hidden rounded-xl border px-4 py-3 text-sm"
            role="status"
            aria-live="polite"
            aria-atomic="true"
            tabindex="-1"
          ></div>
        </form>
      </section>
    </div>

    <section class="border border-trim rounded-2xl p-6" aria-labelledby="my-data-next-title">
      <h2 id="my-data-next-title" class="text-page-inverse text-xl font-semibold mb-4">
        {content.next.heading}
      </h2>
      <List variant="numbered-with-background-list" items={content.next.items} />
    </section>
  </div>
</privacy-form>

<script>
  import { registerPrivacyForm } from '@components/Pages/MyData/client/index'
  registerPrivacyForm()
</script>
