---
// import List from '@components/List/index.astro'
import Icon from '@components/Icon/index.astro'
// import HeadingAnchor from '@components/Layout/HeadingAnchor/index.astro'

export type Props = {
  content: {
    header: {
      title: string
      description: string
    }
  }
}

const { content } = Astro.props
---

<privacy-form class="block">
  <div class="container mx-auto px-4 py-16 max-w-5xl space-y-10">
    <header class="text-center max-w-2xl mx-auto mb-8">
      <div class="inline-flex items-center justify-center w-18 h-18 rounded-full bg-primary/10 mb-5">
        <Icon
          icon="avatar"
          color="page-inverse"
          size={12}
        />
      </div>
      <h1 class="text-4xl md:text-5xl font-bold text-page-inverse mb-4">{content.header.title}</h1>
      <p class="text-lg text-content-offset leading-relaxed mb-4">
        {content.header.description}
      </p>
    </header>

    <div
      id="status-message"
      tabindex="-1"
      role="status"
      aria-live="polite"
      aria-atomic="true"
      class="hidden rounded-xl border px-4 py-3 text-sm"
    ></div>

    <section class="bg-page-offset border border-trim rounded-2xl p-6" aria-labelledby="my-data-intro-title">
      <h2 class="sr-only" id="my-data-intro-title">Overview</h2>
      <p class="text-content-active">
        Use the forms below to request a copy of your data or request its deletion.
      </p>
    </section>

    <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
      <section class="bg-content-inverse border border-trim rounded-2xl p-6 md:p-8" aria-labelledby="my-data-access-title">
        <h2 id="my-data-access-title" class="text-xl font-semibold mb-3">
          <span aria-hidden="true">üì•</span> Access My Data
        </h2>
        <p class="text-content-active">
          Request a copy of personal data we have about you, including consent records and newsletter subscriptions.
        </p>

        <form id="access-form" class="mt-6 space-y-4" novalidate>
          <div class="space-y-2">
            <label for="access-email" class="block text-content-active text-sm font-medium">Email Address</label>
            <input
              type="email"
              id="access-email"
              name="email"
              required
              placeholder="your@email.com"
              class="w-full rounded-md border border-trim bg-content-inverse px-3 py-2 placeholder:text-content-active focus:border-primary focus:ring-0 focus:outline-none transition-colors duration-200"
            />
          </div>

          <button
            type="submit"
            class="inline-flex items-center justify-center rounded-xl px-6 py-3 bg-spotlight hover:bg-spotlight-offset text-white font-semibold transition-colors"
          >
            Request My Data
          </button>

          <div
            id="access-message"
            class="hidden rounded-xl border px-4 py-3 text-sm"
            role="status"
            aria-live="polite"
            aria-atomic="true"
            tabindex="-1"
          ></div>
        </form>
      </section>

      <section class="bg-content-inverse border border-trim rounded-2xl p-6 md:p-8" aria-labelledby="my-data-delete-title">
        <h2 id="my-data-delete-title" class="text-xl font-semibold mb-3">
          <span aria-hidden="true">üóëÔ∏è</span> Delete My Data
        </h2>

        <div class="rounded-xl border border-warning bg-warning-inverse text-warning px-4 py-3 text-sm mb-4">
          <strong><span aria-hidden="true">‚ö†Ô∏è</span> Warning:</strong> This will permanently delete all your data from our systems.
          This action cannot be undone.
        </div>

        <form id="delete-form" class="mt-6 space-y-4" novalidate>
          <div class="space-y-2">
            <label for="delete-email" class="block text-content-active text-sm font-medium">Email Address</label>
            <input
              type="email"
              id="delete-email"
              name="email"
              required
              placeholder="your@email.com"
              class="w-full rounded-md border border-trim bg-content-inverse px-3 py-2 placeholder:text-content-active focus:border-primary focus:ring-0 focus:outline-none transition-colors duration-200"
            />
          </div>

          <label class="flex items-start gap-3 text-sm">
            <input type="checkbox" id="confirm-delete" required class="mt-1" />
            <span>I understand this will permanently delete all my data</span>
          </label>

          <button
            type="submit"
            class="inline-flex items-center justify-center rounded-xl px-6 py-3 bg-danger text-white font-semibold hover:opacity-90 transition-colors"
          >
            Delete My Data
          </button>

          <div
            id="delete-message"
            class="hidden rounded-xl border px-4 py-3 text-sm"
            role="status"
            aria-live="polite"
            aria-atomic="true"
            tabindex="-1"
          ></div>
        </form>
      </section>
    </div>

    <section class="bg-page-offset border border-trim rounded-2xl p-6" aria-labelledby="my-data-next-title">
      <h2 id="my-data-next-title" class="text-xl font-semibold">What Happens Next?</h2>
      <ol class="mt-4 list-decimal ml-6 space-y-3 text-content-active">
        <li>
          <strong>Verification Email:</strong> We'll send a verification link to your email address.
        </li>
        <li>
          <strong>Click the Link:</strong> Click the link in the email to verify your request (expires in 24 hours).
        </li>
        <li>
          <strong>For Access Requests:</strong> Your data will be automatically downloaded as a JSON file.
        </li>
        <li>
          <strong>For Deletion Requests:</strong> Your data will be permanently removed and you'll see a confirmation.
        </li>
      </ol>
    </section>
  </div>
</privacy-form>

<script>
  import { registerPrivacyForm } from '@components/Pages/MyData/client/index'
  registerPrivacyForm()
</script>
