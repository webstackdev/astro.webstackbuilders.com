/**
 * Stylings for Shiki Textmate-based Code Highlighter using VS Code templates
 *
 * Supports dual themes configured in astro.config.mjs:
 * - github-light for light mode
 * - github-dark for dark mode
 */

/**
 * Shiki emits each line as <span class="line">â€¦</span>.
 * We keep line numbers in a fixed gutter so wrapped lines align under the code,
 * not under the line number column.
 */
pre.shiki code {
  counter-increment: step calc(var(--start, 1) - 1);
  counter-reset: step;
  /* Prevent Shiki's inter-line text nodes ("\n") from becoming visual blank lines. */
  white-space: normal;
}

pre.shiki code .line {
  display: block;
  position: relative;
  padding-left: 3rem;
  /* Ensure empty source lines still take up vertical space for line numbers. */
  min-height: 1.25em;
  /* Allow long tokens to wrap inside the code column. */
  white-space: pre-wrap;
  overflow-wrap: anywhere;
}

pre.shiki code .line::before {
  color: rgb(from var(--color-content-active) r g b / 40%);
  content: counter(step);
  counter-increment: step;
  position: absolute;
  left: 0;
  top: 0;
  width: 2rem;
  text-align: right;
}

/* Query based dark mode */

@media (prefers-color-scheme: dark) {
  .shiki-light {
    display: none;
  }
}

@media (prefers-color-scheme: light) {
  .shiki-dark {
    display: none;
  }
}

/* Class based dark mode */

html.dark .shiki-light {
  display: none;
}

html:not(.dark) .shiki-dark {
  display: none;
}