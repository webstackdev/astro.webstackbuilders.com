---
import CookieConsent from '@components/Cookies/Consent/index.astro'
import HeadContent from '@components/Head/index.astro'
import Header from '@components/Header/index.astro'
import Footer from '@components/Footer/index.astro'
import PwaTitleBar from '@components/PwaTitleBar/index.astro'
import Breadcrumbs from '@components/Breadcrumbs/index.astro'
import ThemePicker from '@components/ThemePicker/Themes.astro'

import '@styles/index.css'
import '@styles/sprites.css'

export interface Props {
  pageTitle: string
  /** The URL path component e.g. 'articles/my-article' */
  path: string
  /** Enforce that child is passed to slot */
  children?: unknown
  /** Optional metadata for articles */
  contentType?: 'article' | 'website'
  publishDate?: Date
  modifiedDate?: Date
  author?: string
  section?: string
  tags?: string[]
  description?: string
  image?: string
  noindex?: boolean
}

const {
  pageTitle,
  path,
  contentType,
  publishDate,
  modifiedDate,
  author,
  section,
  tags,
  description,
  image,
  noindex,
} = Astro.props
---

<style>
  /* Container constraints for header and footer elements */
  .layout :global(.header),
  .layout :global(.footer) {
    flex: none;
    margin-left: auto;
    margin-right: auto;
    max-width: 75rem; /* 1200px at 16px font-size */
    width: 90%;
  }
</style>
<!DOCTYPE html>
<html lang="en">
  <head>
    <HeadContent
      pageTitle={pageTitle}
      path={path}
      {...description && { description }}
      {...image && { image }}
      {...noindex && { noindex }}
      {...contentType && { contentType }}
      {...publishDate && { publishDate }}
      {...modifiedDate && { modifiedDate }}
      {...author && { author }}
      {...section && { section }}
      {...tags && { tags }}
    />
  </head>
  <body>
    <a
      href="#main"
      class="sr-only focus:not-sr-only focus:absolute focus:top-0 focus:left-1/2 focus:-translate-x-1/2 focus:px-6 focus:py-4 focus:outline-none focus:z-50 focus:bg-blue-600 focus:text-white focus:rounded"
      >skip to main content</a
    >
    {/* Sets Window Controls Overlay API for PWA title bar */}
    <PwaTitleBar />
    {/* Site header and main content */}
    <div
      class="flex flex-col min-h-screen relative transition-transform duration-300 ease-[cubic-bezier(0.25,0.46,0.45,0.94)]"
      role="document"
      style="padding-top: env(titlebar-area-height, 0);"
    >
      <Header path={path} />
      <div class="mx-auto max-w-[75rem] w-[90%] mt-4">
        <Breadcrumbs path={path} pageTitle={pageTitle} />
      </div>
      <main
        id="main"
        class="flex flex-col flex-[0_1_auto] mx-auto max-w-[75rem] w-[90%]"
        role="main"
        tabindex="-1"
      >
        <slot />
      </main>
      <Footer />
    </div>
    {/* Cookie Consent Overlay */}
    <CookieConsent />
    {/* Theme Picker Modal */}
    <ThemePicker />
  </body>
</html>
