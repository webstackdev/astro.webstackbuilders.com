---
/**
 * Page layout used for item view pages for dynamic collections like articles,
 * case studies, and services, and dynamic token newsletter confirm pages.
 */
import BaseLayout from '@layouts/BaseLayout.astro'

export interface Props {
  pageTitle: string
  /** The URL path component e.g. 'articles/my-article' */
  path: string
  /** Optional page subtitle */
  subtitle?: string
  /** Optional page description for meta tags */
  description?: string
  /** Schema.org itemtype for structured data */
  schemaType?: string
  /** Article metadata for blog posts */
  meta?: {
    date?: Date
    author?: string
    tags?: string[]
    readingTime?: string
    draft?: boolean
  }
}

const {
  pageTitle,
  path,
  subtitle,
  description,
  schemaType = 'http://schema.org/WebPage',
  meta,
} = Astro.props
---

<BaseLayout pageTitle={pageTitle} path={path} {...description && { description }}>
  <article class="page-content" itemscope itemtype={schemaType} aria-labelledby="page-title">
    <header class="page-content__header">
      <h1 id="page-title" class="page-content__title" itemprop="headline">
        {pageTitle}
      </h1>
      {subtitle && <p class="page-content__subtitle">{subtitle}</p>}
      {
        meta && (
          <div class="page-content__meta">
            {meta.date && (
              <time
                class="page-content__date"
                itemprop="datePublished"
                datetime={meta.date.toISOString()}
              >
                {meta.date.toLocaleDateString('en-US', {
                  year: 'numeric',
                  month: 'long',
                  day: 'numeric',
                })}
              </time>
            )}
            {meta.readingTime && (
              <p class="page-content__reading-time">{meta.readingTime} to read</p>
            )}
            {meta.tags && meta.tags.length > 0 && (
              <div class="page-content__tags">
                <span aria-label="in category">&sdot;</span>
                <span class="page-content__tag-list">{meta.tags.join(', ')}</span>
              </div>
            )}
            {meta.draft && (
              <>
                <span aria-hidden="true">&sdot;</span>
                <span class="page-content__status">(Draft)</span>
              </>
            )}
          </div>
        )
      }
    </header>
    <div class="page-content__body content" itemprop="articleBody">
      <slot />
    </div>
  </article>
</BaseLayout>
