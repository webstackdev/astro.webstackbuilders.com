---
/**
 * Newsletter Confirmation Page
 * Handles double opt-in confirmation link from email
 * GDPR-compliant newsletter subscription verification
 *
 * This page calls the API endpoint to process confirmation server-side
 */
import BaseLayout from '@layouts/BaseLayout.astro'
import Header from '@components/Layout/Header/index.astro'
import NewsletterConfirmation from '@components/Newsletter/Confirm/index.astro'

// This is a server-rendered dynamic route
export const prerender = false

const description = 'Double opt-in confirmation for your Webstack Builders newsletter subscription.'
const pageTitle = 'Confirming Your Subscription...'

const { token } = Astro.params

if (typeof token !== 'string' || token.trim().length === 0) {
  throw new Response(null, { status: 404 })
}
---

<BaseLayout pageTitle={pageTitle} path={"/newsletter/confirm"} description={description}>
  <Header
    title={pageTitle}
    description={description}
    icon="document"
  />
  <NewsletterConfirmation token={token} />
</BaseLayout>
