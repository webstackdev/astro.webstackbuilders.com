---
/**
 * Newsletter Confirmation Page
 * Handles double opt-in confirmation link from email
 * GDPR-compliant newsletter subscription verification
 *
 * This page calls the API endpoint to process confirmation server-side
 */
import PageLayout from '@layouts/PageLayout.astro'
import NewsletterConfirmation from '@components/Newsletter/Confirm/index.astro'

// This is a server-rendered dynamic route
export const prerender = false

const description = 'Double opt-in confirmation for your Webstack Builders newsletter subscription.'
const pageTitle = 'Confirming Your Subscription...'
const section = 'Newsletter Subscription Confirmation'
const subtitle = 'Please wait while we confirm your subscription'

const { token } = Astro.params

if (typeof token !== 'string' || token.trim().length === 0) {
  throw new Response(null, { status: 404 })
}
---

<PageLayout
  pageTitle={pageTitle}
  path="newsletter/confirm"
  section={section}
  subtitle={subtitle}
  description={description}
>
  <NewsletterConfirmation token={token} />
</PageLayout>
