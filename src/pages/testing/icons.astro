---
import Icon, { colorClasses } from '@components/Icon/index.astro'
import type { IconVariant } from '@components/Icon/index.astro'
import BaseLayout from '@layouts/BaseLayout.astro'

const variantNames = Object.keys(colorClasses) as IconVariant[]
const iconModules = import.meta.glob('../../icons/*.svg')
const iconNames = Object.keys(iconModules)
  .map(path => path.split('/').pop()?.replace('.svg', ''))
  .filter((name): name is string => Boolean(name))
  .sort()

const pageTitle = 'Icon Variant Gallery'
const description =
  'Preview every icon across each color variant to verify styling and availability.'
---

<BaseLayout pageTitle={pageTitle} path="/testing/icons" description={description}>
  <main class="mx-auto flex max-w-7xl flex-col gap-12 px-6 py-12">
    <header class="text-center">
      <p class="text-sm uppercase tracking-wide text-text-muted">Design System</p>
      <h1 class="mt-2 text-4xl font-bold text-text">{pageTitle}</h1>
      <p class="mt-4 text-text-muted">
        Every icon from <code class="rounded bg-bg-offset px-1 py-0.5 text-sm">src/icons</code> rendered
        across each color variant.
      </p>
    </header>

    {
      variantNames.map(variant => (
        <section class="space-y-6" aria-labelledby={`icon-variant-${variant}`}>
          <div class="flex items-baseline justify-between flex-wrap gap-3">
            <div>
              <p class="text-sm uppercase tracking-wide text-text-muted">Variant</p>
              <h2
                id={`icon-variant-${variant}`}
                class="text-2xl font-semibold text-text capitalize"
              >
                {variant}
              </h2>
            </div>
            <p class="text-sm text-text-muted">{iconNames.length} icons</p>
          </div>
          <div class="flex flex-wrap gap-6">
            {iconNames.map(iconName => (
              <div class="flex min-w-[200px] flex-1 basis-[220px] flex-col items-center justify-between rounded-xl border border-border bg-bg p-8 text-center">
                <Icon name={iconName} variant={variant} size={56} />
                <span class="mt-6 w-full border-t border-dashed border-border pt-4 text-sm font-mono text-text">
                  {iconName}
                </span>
              </div>
            ))}
          </div>
        </section>
      ))
    }
  </main>
</BaseLayout>
